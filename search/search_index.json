{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u00cdndice de contenidos \u00cdndice con las diferentes secciones de los contenidos de la documentaci\u00f3n: Apartado 1 - Trazado de vulnerabilidad Apartado 2 - An\u00e1lisis de vulnerabilidad Apartado 3 - Comprobaci\u00f3n de los requisitos de Seguridad de una aplicaci\u00f3n Reflexi\u00f3n","title":"1. \u00cdndice"},{"location":"#indice-de-contenidos","text":"\u00cdndice con las diferentes secciones de los contenidos de la documentaci\u00f3n: Apartado 1 - Trazado de vulnerabilidad Apartado 2 - An\u00e1lisis de vulnerabilidad Apartado 3 - Comprobaci\u00f3n de los requisitos de Seguridad de una aplicaci\u00f3n Reflexi\u00f3n","title":"\u00cdndice de contenidos"},{"location":"ComprobacionRequisitosAplicacion/","text":"","title":"4. Comprobaci\u00f3n de requisitos de Seguridad de una aplicaci\u00f3n"},{"location":"TrazadoVulnerabilidadGoAnywhere/","text":"Apartado 1 - Trazado de una vulnerabilidad En este apartado muestro el desarrollo que he realizado de la Actividad- TrazadoVulnerabilidad . El trazado de la vulnerabilidad de la que se informa en la actividad se corresponde a la de este art\u00edculo del INCIBE . 1. Trazado Se informa de una vulnerabilidad cr\u00edtica relacionada con la omisi\u00f3n de autenticaci\u00f3n en GoAnywhere MFT de Fortra . La fecha de publicaci\u00f3n se corresponde al 24 de enero de 2024 y la importancia tiene un nivel 5, es decir, cr\u00edtica . La vulnerabilidad afecta desde la versi\u00f3n 6.0.1 hasta la 7.4.1. Tambi\u00e9n encuentro una descripci\u00f3n en la que se me indica que la vulnerabilidad permite a los ciberdelincuentes crear un usuario administrador a partir del portal de administraci\u00f3n, eludiendo as\u00ed los requisitos de autenticaci\u00f3n en el acceso a un servicio. B\u00e1sicamente un ciberdelincuente puede crear un usuario con m\u00e1ximos privilegios a trav\u00e9s de este portal de administraci\u00f3n, con lo que ello supone. Se indica la soluci\u00f3n, que ser\u00eda actualizar a la versi\u00f3n 7.4.1 o superior o eliminar el archivo InitialAccountSetup.xhtml en el directorio de instalaci\u00f3n en caso de despliegues sin contenedor. Con despliegues en contenedor, habr\u00eda que reemplazar dicho archivo por uno limpio y reiniciar. Se aportan enlaces para obtener m\u00e1s informaci\u00f3n desde el portal de clientes de GoAnywhere. 2. Informaci\u00f3n sobre las vulnerabilidades En este punto, s\u00e9 a qu\u00e9 elementos afecta la vulnerabilidad, pero no tengo enlace para dirigirme a las diferentes listas, por lo que me ir\u00e9 al enlace del apartado de \"referencias\" del art\u00edculo: enlace referencia . En la referencia, se vuelve a describir que la vulnerabilidad se debe a un Bypass que pueden realizar los ciberdelicuentes desde el portal de administraci\u00f3n. Tambi\u00e9n se indica la severidad, el impacto que tiene y las soluciones. B\u00e1sicamente, lo mismo que se muesta en el art\u00edculo del INCIBE. Lo que encuentro aqu\u00ed es la identificaci\u00f3n de una \u00fanica vulnerabilidad, ya se indica un \u00fanico CVE . CVE es una lista mantenida por el MITRE en donde, cuando alguien encuentra una vulnerabilidad env\u00eda un reporte y ellos la estudian para determinar si ya est\u00e1 reportada o no, y en tal caso, asignarle un n\u00famero identificativo. Este n\u00famero consistir\u00eda en CVE, seguido del n\u00famero de a\u00f1o y un n\u00famero correlativo. En este punto, tengo la vulnerabilidad CVE-2024-0204 . 3. Informaci\u00f3n sobre el riesgo o criticidad de una vulnerabilidad Ahora lo que har\u00e9 ser\u00e1 buscar la vulnerabilidad en el MITTRE y en la base de datos del gobierno de Estados Unidos, la NVD . Indico que, en ambos sitios, la informaci\u00f3n obtenida es muy similar. NVD Encuentro la descripci\u00f3n de la vulnerabilidad y la m\u00e9trica. La m\u00e9trica es la forma de calcular el nivel de criticidad de la vulnerabilidad (CVSS). Si me fijo en el CVSS, puedo observar que depende de varios factores: Vector de ataque: Se trata de la facilidad del vector de ataque, que var\u00eda. Por ejemplo, no ser\u00eda lo mismo necesitar acceso f\u00edsico al ordenador para realizar el ataque que realizarlo desde cualquier sitio, a trav\u00e9s de la red. En este caso se realiza desde la red. Complejidad del ataque: Se trata de ver si es sencillo realizarlo o no. En este caso es la complejidad es baja. Privilegios: Son la cantidad de privilegios que se requieren para hacer el ataque. Por ejemplo, no ser\u00eda lo mismo necesitar ser un usuario logeado para hacerlo que hacerlo desde \"fuera\". En este caso no se necesitan privilegios. Inteacci\u00f3n con el usuario: Est\u00e1 m\u00e1s limitado el poder hacerlo con un usuario que realizarlo con una herramienta autom\u00e1tica. En este caso no se requiere interaci\u00f3n con el usuario. Confidencialidad, integridad y disponibilidad: Afecta a los tres pilares fundamentales de la ciberseguridad de manera muy alta. Conocimiento: Si es conocida la vulnerabilidad, tiene m\u00e1s impacto que si no lo es. En este caso tiene un 5.9 de impacto. Con todos estos factores, se ha determinado que la vulnerabilidad sea cr\u00edtica, con un 9.8. En la lista de debilidades encuentro una debilidad que afecta a la vulnerabilidad encontrada: CWE-425 : Solicitud directa (navegaci\u00f3n forzada). ** MITTRE** En el MITTRE encuentro informaci\u00f3n muy similar a la de la NVD, pero con menos detalles. Por ejemplo, en la m\u00e9trica, no se detallan los factores para calcular la criticidad de la vulnerabilidad. La debilidad coincide con la de la NVD. 4. Informaci\u00f3n sobre patrones de ataque Sigo realizando la trazabilidad desde el enlace de la debilidad CWE . Destacar que realizo la consulta en la vista \"Completa\". El CWE forma parte del MITTRE y se encarga de recopilar informaci\u00f3n de las debilidades. Se indica en la descripci\u00f3n de la debilidad qe la aplicaci\u00f3n web mo hace cumplir adecuadamente la autorizaci\u00f3n en todas las URL, scripts o archivos restringidos. LAs aplicaciones web susceptibles a estos ataques hacen una falsa suposici\u00f3n de que tales recursos solo se pueden alcanzar a trav\u00e9s de una ruta de navegaci\u00f3n determinada y solo aplican autorizaci\u00f3n en ciertos puntos. Se muestran las mitigaciones a esta debilidad: Aplicar autorizaciones de control de acceso para cada acceso a todas las URL, scripts o archivos restringidos. Hacer uso de marcos basados en MVC como Struts . Se muestran las relaciones. Est\u00e1n indicados los diferentes ID correspondientes a las debilidades asociadas, junto a su naturaleza, descripci\u00f3n y tipo (si pongo el cursor sobre el tipo, se muestra informaci\u00f3n m\u00e1s detallada). Se muestra un \u00fanico ejemplo de c\u00f3mo ser\u00eda posible la navegaci\u00f3n forzada y una lista de ejemplos para entender las variedades de formas en las que se puede introducir la debilidad, con sus correspondientes CVE. Se muestran los diferentes CAPEC, que son los patrones de ataque para atacar la debilidad. Los diferentes patrones de ataque que encuentro en esta debilidad son los siguientes: CAPEC-127 : Indexaci\u00f3n de directorios CAPEC-143 : Detectar p\u00e1ginas web no publicitadas CAPEC-144 : Detectar servicios de web no publicitados CAPEC-668 : Negociaci\u00f3n clave de ataque Bluetooth (KNOB) CAPEC-87 : Ex\u00e1menes contundentes En el siguiente v\u00eddeo muestro el CAPEC-127. Todos los CAPEC tienen pr\u00e1cticamente los mismos apartados en los que: CAPEC Se muestra una descripci\u00f3n del patr\u00f3n de ataque. Se muestra una probabilidad de ataque. Se le da un valor a la gravedad del ataque. Se muestran relaciones con otros patrones de ataque. Se explica el flujo de ejecuci\u00f3n (exploraci\u00f3n, experimentaci\u00f3n y exploit). Se dan los requisitos previos. Se especifican las habilidades requeridas para ejecutarlo. Se muestran los recursos requeridos. Se muestan las consecuencias. Se indican las mitigaciones. Se dan ejemplos de escenarios. Se muestran debilidades relacionadas con su correspondiente CWE. Se muesta un mapeo de la taxonom\u00eda y referencias. 5. Consulta CPE Llegado a este punto, he relacionado tres listas, la de vulnerabilidades (CVE - MITTRE / NVD), la de vulnerabilidades (CWE) y la de patrones de ataque (CAPEC). Adicionalmente, puedo consultar las listas (CPE) del NVD. Son listas de las configuraciones de software conocidas. Es una estructura establecida que nos indica los elementos afectados. (CPE:version:fabricante:software:componentes) El CPE sirve para herramientas automatizadas. Los diferentes programas de detecci\u00f3n y explotaci\u00f3n de vulnerabilidades se intercambian informaci\u00f3n a trav\u00e9s de registros, y gracias a estos CPE podemos ver qu\u00e9 elementos son susceptibles de ataques. 6. Registro CVE Descarga del Registro CVE De la vulnerabilidad Toda la informaci\u00f3n obtenida para intercambiar o a\u00f1adir a diferentes programas de explotaci\u00f3n o detecci\u00f3n de vulnerabilidades, o que directamente va a bases de datos la podemos descargar en formato de JSON. De esta forma tendremos acceso a toda la informaci\u00f3n y ser\u00e1 interpretable entre los diferentes programas que utilizamos para detectar, atacar, etc. Para descargar el JSON de la vulnerabilidad de la actividad, en la parte superior derecha del CVE clicamos sobre \"View JSON\": A continuaci\u00f3n dejo una captura de pantalla con la vista del JSON. Podemos observar diferente informaci\u00f3n acerca de la debilidad (versi\u00f3n, ID, CVE, CWS...): Descargar JSON: Archivo JSON","title":"2. Trazado de vulnerabilidad"},{"location":"TrazadoVulnerabilidadGoAnywhere/#apartado-1-trazado-de-una-vulnerabilidad","text":"En este apartado muestro el desarrollo que he realizado de la Actividad- TrazadoVulnerabilidad . El trazado de la vulnerabilidad de la que se informa en la actividad se corresponde a la de este art\u00edculo del INCIBE .","title":"Apartado 1 - Trazado de una vulnerabilidad"},{"location":"TrazadoVulnerabilidadGoAnywhere/#1-trazado","text":"Se informa de una vulnerabilidad cr\u00edtica relacionada con la omisi\u00f3n de autenticaci\u00f3n en GoAnywhere MFT de Fortra . La fecha de publicaci\u00f3n se corresponde al 24 de enero de 2024 y la importancia tiene un nivel 5, es decir, cr\u00edtica . La vulnerabilidad afecta desde la versi\u00f3n 6.0.1 hasta la 7.4.1. Tambi\u00e9n encuentro una descripci\u00f3n en la que se me indica que la vulnerabilidad permite a los ciberdelincuentes crear un usuario administrador a partir del portal de administraci\u00f3n, eludiendo as\u00ed los requisitos de autenticaci\u00f3n en el acceso a un servicio. B\u00e1sicamente un ciberdelincuente puede crear un usuario con m\u00e1ximos privilegios a trav\u00e9s de este portal de administraci\u00f3n, con lo que ello supone. Se indica la soluci\u00f3n, que ser\u00eda actualizar a la versi\u00f3n 7.4.1 o superior o eliminar el archivo InitialAccountSetup.xhtml en el directorio de instalaci\u00f3n en caso de despliegues sin contenedor. Con despliegues en contenedor, habr\u00eda que reemplazar dicho archivo por uno limpio y reiniciar. Se aportan enlaces para obtener m\u00e1s informaci\u00f3n desde el portal de clientes de GoAnywhere.","title":"1. Trazado"},{"location":"TrazadoVulnerabilidadGoAnywhere/#2-informacion-sobre-las-vulnerabilidades","text":"En este punto, s\u00e9 a qu\u00e9 elementos afecta la vulnerabilidad, pero no tengo enlace para dirigirme a las diferentes listas, por lo que me ir\u00e9 al enlace del apartado de \"referencias\" del art\u00edculo: enlace referencia . En la referencia, se vuelve a describir que la vulnerabilidad se debe a un Bypass que pueden realizar los ciberdelicuentes desde el portal de administraci\u00f3n. Tambi\u00e9n se indica la severidad, el impacto que tiene y las soluciones. B\u00e1sicamente, lo mismo que se muesta en el art\u00edculo del INCIBE. Lo que encuentro aqu\u00ed es la identificaci\u00f3n de una \u00fanica vulnerabilidad, ya se indica un \u00fanico CVE . CVE es una lista mantenida por el MITRE en donde, cuando alguien encuentra una vulnerabilidad env\u00eda un reporte y ellos la estudian para determinar si ya est\u00e1 reportada o no, y en tal caso, asignarle un n\u00famero identificativo. Este n\u00famero consistir\u00eda en CVE, seguido del n\u00famero de a\u00f1o y un n\u00famero correlativo. En este punto, tengo la vulnerabilidad CVE-2024-0204 .","title":"2. Informaci\u00f3n sobre las vulnerabilidades"},{"location":"TrazadoVulnerabilidadGoAnywhere/#3-informacion-sobre-el-riesgo-o-criticidad-de-una-vulnerabilidad","text":"Ahora lo que har\u00e9 ser\u00e1 buscar la vulnerabilidad en el MITTRE y en la base de datos del gobierno de Estados Unidos, la NVD . Indico que, en ambos sitios, la informaci\u00f3n obtenida es muy similar. NVD Encuentro la descripci\u00f3n de la vulnerabilidad y la m\u00e9trica. La m\u00e9trica es la forma de calcular el nivel de criticidad de la vulnerabilidad (CVSS). Si me fijo en el CVSS, puedo observar que depende de varios factores: Vector de ataque: Se trata de la facilidad del vector de ataque, que var\u00eda. Por ejemplo, no ser\u00eda lo mismo necesitar acceso f\u00edsico al ordenador para realizar el ataque que realizarlo desde cualquier sitio, a trav\u00e9s de la red. En este caso se realiza desde la red. Complejidad del ataque: Se trata de ver si es sencillo realizarlo o no. En este caso es la complejidad es baja. Privilegios: Son la cantidad de privilegios que se requieren para hacer el ataque. Por ejemplo, no ser\u00eda lo mismo necesitar ser un usuario logeado para hacerlo que hacerlo desde \"fuera\". En este caso no se necesitan privilegios. Inteacci\u00f3n con el usuario: Est\u00e1 m\u00e1s limitado el poder hacerlo con un usuario que realizarlo con una herramienta autom\u00e1tica. En este caso no se requiere interaci\u00f3n con el usuario. Confidencialidad, integridad y disponibilidad: Afecta a los tres pilares fundamentales de la ciberseguridad de manera muy alta. Conocimiento: Si es conocida la vulnerabilidad, tiene m\u00e1s impacto que si no lo es. En este caso tiene un 5.9 de impacto. Con todos estos factores, se ha determinado que la vulnerabilidad sea cr\u00edtica, con un 9.8. En la lista de debilidades encuentro una debilidad que afecta a la vulnerabilidad encontrada: CWE-425 : Solicitud directa (navegaci\u00f3n forzada). ** MITTRE** En el MITTRE encuentro informaci\u00f3n muy similar a la de la NVD, pero con menos detalles. Por ejemplo, en la m\u00e9trica, no se detallan los factores para calcular la criticidad de la vulnerabilidad. La debilidad coincide con la de la NVD.","title":"3. Informaci\u00f3n sobre el riesgo o criticidad de una vulnerabilidad"},{"location":"TrazadoVulnerabilidadGoAnywhere/#4-informacion-sobre-patrones-de-ataque","text":"Sigo realizando la trazabilidad desde el enlace de la debilidad CWE . Destacar que realizo la consulta en la vista \"Completa\". El CWE forma parte del MITTRE y se encarga de recopilar informaci\u00f3n de las debilidades. Se indica en la descripci\u00f3n de la debilidad qe la aplicaci\u00f3n web mo hace cumplir adecuadamente la autorizaci\u00f3n en todas las URL, scripts o archivos restringidos. LAs aplicaciones web susceptibles a estos ataques hacen una falsa suposici\u00f3n de que tales recursos solo se pueden alcanzar a trav\u00e9s de una ruta de navegaci\u00f3n determinada y solo aplican autorizaci\u00f3n en ciertos puntos. Se muestran las mitigaciones a esta debilidad: Aplicar autorizaciones de control de acceso para cada acceso a todas las URL, scripts o archivos restringidos. Hacer uso de marcos basados en MVC como Struts . Se muestran las relaciones. Est\u00e1n indicados los diferentes ID correspondientes a las debilidades asociadas, junto a su naturaleza, descripci\u00f3n y tipo (si pongo el cursor sobre el tipo, se muestra informaci\u00f3n m\u00e1s detallada). Se muestra un \u00fanico ejemplo de c\u00f3mo ser\u00eda posible la navegaci\u00f3n forzada y una lista de ejemplos para entender las variedades de formas en las que se puede introducir la debilidad, con sus correspondientes CVE. Se muestran los diferentes CAPEC, que son los patrones de ataque para atacar la debilidad. Los diferentes patrones de ataque que encuentro en esta debilidad son los siguientes: CAPEC-127 : Indexaci\u00f3n de directorios CAPEC-143 : Detectar p\u00e1ginas web no publicitadas CAPEC-144 : Detectar servicios de web no publicitados CAPEC-668 : Negociaci\u00f3n clave de ataque Bluetooth (KNOB) CAPEC-87 : Ex\u00e1menes contundentes En el siguiente v\u00eddeo muestro el CAPEC-127. Todos los CAPEC tienen pr\u00e1cticamente los mismos apartados en los que: CAPEC Se muestra una descripci\u00f3n del patr\u00f3n de ataque. Se muestra una probabilidad de ataque. Se le da un valor a la gravedad del ataque. Se muestran relaciones con otros patrones de ataque. Se explica el flujo de ejecuci\u00f3n (exploraci\u00f3n, experimentaci\u00f3n y exploit). Se dan los requisitos previos. Se especifican las habilidades requeridas para ejecutarlo. Se muestran los recursos requeridos. Se muestan las consecuencias. Se indican las mitigaciones. Se dan ejemplos de escenarios. Se muestran debilidades relacionadas con su correspondiente CWE. Se muesta un mapeo de la taxonom\u00eda y referencias.","title":"4. Informaci\u00f3n sobre patrones de ataque"},{"location":"TrazadoVulnerabilidadGoAnywhere/#5-consulta-cpe","text":"Llegado a este punto, he relacionado tres listas, la de vulnerabilidades (CVE - MITTRE / NVD), la de vulnerabilidades (CWE) y la de patrones de ataque (CAPEC). Adicionalmente, puedo consultar las listas (CPE) del NVD. Son listas de las configuraciones de software conocidas. Es una estructura establecida que nos indica los elementos afectados. (CPE:version:fabricante:software:componentes) El CPE sirve para herramientas automatizadas. Los diferentes programas de detecci\u00f3n y explotaci\u00f3n de vulnerabilidades se intercambian informaci\u00f3n a trav\u00e9s de registros, y gracias a estos CPE podemos ver qu\u00e9 elementos son susceptibles de ataques.","title":"5. Consulta CPE"},{"location":"TrazadoVulnerabilidadGoAnywhere/#6-registro-cve","text":"Descarga del Registro CVE De la vulnerabilidad Toda la informaci\u00f3n obtenida para intercambiar o a\u00f1adir a diferentes programas de explotaci\u00f3n o detecci\u00f3n de vulnerabilidades, o que directamente va a bases de datos la podemos descargar en formato de JSON. De esta forma tendremos acceso a toda la informaci\u00f3n y ser\u00e1 interpretable entre los diferentes programas que utilizamos para detectar, atacar, etc. Para descargar el JSON de la vulnerabilidad de la actividad, en la parte superior derecha del CVE clicamos sobre \"View JSON\": A continuaci\u00f3n dejo una captura de pantalla con la vista del JSON. Podemos observar diferente informaci\u00f3n acerca de la debilidad (versi\u00f3n, ID, CVE, CWS...): Descargar JSON: Archivo JSON","title":"6. Registro CVE"},{"location":"analisisVulnerabilidad/","text":"Apartado 2 - Creaci\u00f3n de entorno de m\u00e1quinas vulnerables para pruebas. En este apartado muestro c\u00f3mo he realizado el desarrollo de la Actividad- TrazadoVulnerabilidad . En el apartado 1 he realizado el trazado de una vulnerabilidad, buscando informaci\u00f3n de una vulnerabiliad concreta y sus debilidades en las diferentes fuentes web abiertas. En esta actividad me centro en desplegar un entorno con un conjunto de m\u00e1quinas para probar los ataques y poder ver tambi\u00e9n c\u00f3mo se securizan. 1. Entorno de m\u00e1quinas virtuales En primer lugar, voy a explicar las diferentes m\u00e1quinas que hay en el archivo docker-compose.yml . Este archivo le tengo en el directorio desde el que voy a trabajar esta actividad y desde el cual voy a desplegar el contenedor ( /home/PPSOscar/Escritorio/PPS/Unidad2/Actividad-MaquinasVulnerables1 ). En este primer grupo tengo tres m\u00e1quinas: DVWA imagen de dvwa contenedor dvwa hostname mismo que el contenedor redirecci\u00f3n de puertos al 8002 (por el que voy a acceder a la m\u00e1quina) red labpps-net BWAPP imagen de bwapp contenedor bwapp hostname mismo que el contenedor redirecci\u00f3n de puertos al 8001 (por el que voy a acceder a la m\u00e1quina) red labpps-net KALI imagen de kali contenedor kali hostname mismo que el contenedor volumen bind mount (kali-volume) que se montar\u00e1 en /root/kali red labpps-net En el segundo grupo encuentro varios contenedores: Base de datos Base de datos de administrador accesible a trav\u00e9s del puerto 81 M\u00e1quina www (servidor web) Tenemos una serie de puertos abiertos Utiliza dos redes (datanet / labpps-net), para conectarse con nuestra m\u00e1quina y con la base de datos Directory. Es un LDAP . Accesinle mediante el puerto 389. Directory admin accesible a trav\u00e9s del puerto 82. En el tercer grupo tenemos los segmetnos de las redes: Encontramos las dos redes utilizadas. Tenemos los vol\u00famenes utilizados 2. Despliegue de escenario A continuaci\u00f3n lo que hago es desplegar el escenario del contenedor ( docker compose up -d ). Lo primero que hago es descargar todas las im\u00e1genes. 3. Acceso a las m\u00e1quinas y creaci\u00f3n de bases de datos Seguidamente, abrir\u00e9 las diferentes m\u00e1quinas vulnerables. DWA: A trav\u00e9s de localhost:8002 (usuario admin / contrase\u00f1a password) Lo primero que me dice es que tengo que inicializar la base de datos. Una vez creada la base de datos, ya tengo disponibles las instrucciones y los diferentes ataques a poder realizar. bWAPP: A trav\u00e9s de localhost:8001 (usuario bee / contrase\u00f1a bug) La primera vez que accedo da error porque no tiene creada la base de datos. Se crea accediendo a creaci\u00f3n base de datos Desde esta m\u00e1quina tengo acceso a varios ataques (ver listado) y puedo seleccionar la dificultad de los ataques. OWASP Multillidae: A trav\u00e9s de localhost:8080 o localhost:80 (sin usuario ni contrase\u00f1a) La primera vez que accedo se pide crear la bases de datos. Una vez creada la base de datos puedo acceder a las diferentes ataques y las diferentes vulnerabilidades a\u00f1adidas en distintos a\u00f1os. phpAdmin Puedo acceder a la base de datos (panel de administraci\u00f3n de phpMyAdmin ) para crear registos, modificar base de datos, etc. A trav\u00e9s de localhost:81 PhpLdapAdmin Puedo acceder tambi\u00e9n a PhpLdapAdmin, desde donde puedo modificar el servidor LDAP. A trav\u00e9s de localhost:82 4. An\u00e1lisis de vulnerabilidad Llegado a este punto, el escenadrio multi contenedor est\u00e1 ya creado. Paso ahora a analizar determinados ataques y ver la securizaci\u00f3n y elementos utilizados para securizar. Voy a realizar un ataque SQL Injection (Get/Search) . Esta vulnerabilidad ocurre cuando una aplicaci\u00f3n web inserta directamente lo que escribe el usuario dentro de una consulta SQL, sin validarlo ni protegerlo. En el caso del buscador de pel\u00edculas de bWAPP, el usuario escribe algo en el buscador y ese texto se env\u00eda por la URL mediante el m\u00e9todo GET. El servidor construye una consulta SQL usando directamente ese texto, y si no hay protecci\u00f3n, el usuario puede modificar directamente la consulta SQL original. Hago un ejemplo conceptual para que se entienda mejor: Internamente la aplicaci\u00f3n hace algo as\u00ed: SELECT * FROM movies WHERE title LIKE '%avatar%'; El problema surge cuando se escriben caracteres especiales como por ejemplo ' . Hace que la consulta se rompa y demuestra que la aplicaci\u00f3n no filtra ni escapa correctamente la entrada. Se devuelve texto de error de sintaxis. Ahora, inspeccionar\u00e9 el c\u00f3digo que trata el input para ver qu\u00e9 est\u00e1 haciendo la aplicaci\u00f3n. Se puede ver en la URL que el c\u00f3digo duente que he ejecutado es sqli 1.php. Accedo al contenedor de bWAPP ( docker exec -it bwapp /bin/bash ) y muestro el contenido del archivo ( nano /var/www/html/sqli1.php ). Aqu\u00ed se muestra la funci\u00f3n con lo que se ha de realizar en base al nivel de seguridad que hayamos establecido en bWAPP. Con el nivel de seguridad m\u00e1s bajo, el 0, lo que hace la funci\u00f3n es llamar a la funci\u00f3n no_check(). Con otros niveles de seguridad se llama a las funciones xsscheck1 y xsscheck3. Indico enlace para descargar archivo completo y poder revisarlo: Descargar sqli_1.php En alguno de los siguientes m\u00f3dulos es donde se encuentran las funciones. Busco con grep para localizar los ficheros en los que aparece y la l\u00ednea Las funciones se encontraron en el archivo functions_external.php, en las l\u00edneas 19, 88 y 115. La funci\u00f3n devuelve un dato en $data y lo devuelve exactamente igual, sin validar ni filtrar ni limpiar ni proteger. No hace ning\u00fan tipo de comprobaci\u00f3n de seguridad. En una aplicaci\u00f3n seguria, antes de usar lo que el usuario escribe, se har\u00eda algo como eliminar comillas, escapar caracteres especiales, validar la longitud o usar consultas preparadas. Dejo enlace para descargar el archivo completo Descargar function_external.php En caso de que se utilizase seguridad media, La funci\u00f3n xss_check_1() aplica un filtrado insuficiente, ya que \u00fanicamente convierte los caracteres mayor que (<) y menor que (<) a entidades HTML. Adem\u00e1s, posteriormente aplica urldecode(), lo que permite que un atacante utilice codificaci\u00f3n URL para evadir el filtrado. Como consecuencia, es posible introducir c\u00f3digo malicioso que ser\u00e1 decodificado y ejecutado por el navegador, manteniendo la vulnerabilidad XSS. En caso de utilizar seguridad alta, La funci\u00f3n xss_check_3() implementa una mitigaci\u00f3n adecuada frente a ataques XSS mediante el uso de htmlspecialchars() con la opci\u00f3n ENT_QUOTES y codificaci\u00f3n UTF-8. De esta forma, todos los caracteres especiales potencialmente peligrosos (<, >, \", ', &) se convierten en entidades HTML, impidiendo que el navegador los interprete como c\u00f3digo ejecutable. A diferencia de las funciones anteriores, esta implementaci\u00f3n s\u00ed representa una defensa correcta frente a XSS reflejado.","title":"3. An\u00e1lisis de vulnerabilidad en m\u00e1quina vulnerable"},{"location":"analisisVulnerabilidad/#apartado-2-creacion-de-entorno-de-maquinas-vulnerables-para-pruebas","text":"En este apartado muestro c\u00f3mo he realizado el desarrollo de la Actividad- TrazadoVulnerabilidad . En el apartado 1 he realizado el trazado de una vulnerabilidad, buscando informaci\u00f3n de una vulnerabiliad concreta y sus debilidades en las diferentes fuentes web abiertas. En esta actividad me centro en desplegar un entorno con un conjunto de m\u00e1quinas para probar los ataques y poder ver tambi\u00e9n c\u00f3mo se securizan.","title":"Apartado 2 - Creaci\u00f3n de entorno de m\u00e1quinas vulnerables para pruebas."},{"location":"analisisVulnerabilidad/#1-entorno-de-maquinas-virtuales","text":"En primer lugar, voy a explicar las diferentes m\u00e1quinas que hay en el archivo docker-compose.yml . Este archivo le tengo en el directorio desde el que voy a trabajar esta actividad y desde el cual voy a desplegar el contenedor ( /home/PPSOscar/Escritorio/PPS/Unidad2/Actividad-MaquinasVulnerables1 ). En este primer grupo tengo tres m\u00e1quinas: DVWA imagen de dvwa contenedor dvwa hostname mismo que el contenedor redirecci\u00f3n de puertos al 8002 (por el que voy a acceder a la m\u00e1quina) red labpps-net BWAPP imagen de bwapp contenedor bwapp hostname mismo que el contenedor redirecci\u00f3n de puertos al 8001 (por el que voy a acceder a la m\u00e1quina) red labpps-net KALI imagen de kali contenedor kali hostname mismo que el contenedor volumen bind mount (kali-volume) que se montar\u00e1 en /root/kali red labpps-net En el segundo grupo encuentro varios contenedores: Base de datos Base de datos de administrador accesible a trav\u00e9s del puerto 81 M\u00e1quina www (servidor web) Tenemos una serie de puertos abiertos Utiliza dos redes (datanet / labpps-net), para conectarse con nuestra m\u00e1quina y con la base de datos Directory. Es un LDAP . Accesinle mediante el puerto 389. Directory admin accesible a trav\u00e9s del puerto 82. En el tercer grupo tenemos los segmetnos de las redes: Encontramos las dos redes utilizadas. Tenemos los vol\u00famenes utilizados","title":"1. Entorno de m\u00e1quinas virtuales"},{"location":"analisisVulnerabilidad/#2-despliegue-de-escenario","text":"A continuaci\u00f3n lo que hago es desplegar el escenario del contenedor ( docker compose up -d ). Lo primero que hago es descargar todas las im\u00e1genes.","title":"2. Despliegue de escenario"},{"location":"analisisVulnerabilidad/#3-acceso-a-las-maquinas-y-creacion-de-bases-de-datos","text":"Seguidamente, abrir\u00e9 las diferentes m\u00e1quinas vulnerables. DWA: A trav\u00e9s de localhost:8002 (usuario admin / contrase\u00f1a password) Lo primero que me dice es que tengo que inicializar la base de datos. Una vez creada la base de datos, ya tengo disponibles las instrucciones y los diferentes ataques a poder realizar. bWAPP: A trav\u00e9s de localhost:8001 (usuario bee / contrase\u00f1a bug) La primera vez que accedo da error porque no tiene creada la base de datos. Se crea accediendo a creaci\u00f3n base de datos Desde esta m\u00e1quina tengo acceso a varios ataques (ver listado) y puedo seleccionar la dificultad de los ataques. OWASP Multillidae: A trav\u00e9s de localhost:8080 o localhost:80 (sin usuario ni contrase\u00f1a) La primera vez que accedo se pide crear la bases de datos. Una vez creada la base de datos puedo acceder a las diferentes ataques y las diferentes vulnerabilidades a\u00f1adidas en distintos a\u00f1os. phpAdmin Puedo acceder a la base de datos (panel de administraci\u00f3n de phpMyAdmin ) para crear registos, modificar base de datos, etc. A trav\u00e9s de localhost:81 PhpLdapAdmin Puedo acceder tambi\u00e9n a PhpLdapAdmin, desde donde puedo modificar el servidor LDAP. A trav\u00e9s de localhost:82","title":"3. Acceso a las m\u00e1quinas y creaci\u00f3n de bases de datos"},{"location":"analisisVulnerabilidad/#4-analisis-de-vulnerabilidad","text":"Llegado a este punto, el escenadrio multi contenedor est\u00e1 ya creado. Paso ahora a analizar determinados ataques y ver la securizaci\u00f3n y elementos utilizados para securizar. Voy a realizar un ataque SQL Injection (Get/Search) . Esta vulnerabilidad ocurre cuando una aplicaci\u00f3n web inserta directamente lo que escribe el usuario dentro de una consulta SQL, sin validarlo ni protegerlo. En el caso del buscador de pel\u00edculas de bWAPP, el usuario escribe algo en el buscador y ese texto se env\u00eda por la URL mediante el m\u00e9todo GET. El servidor construye una consulta SQL usando directamente ese texto, y si no hay protecci\u00f3n, el usuario puede modificar directamente la consulta SQL original. Hago un ejemplo conceptual para que se entienda mejor: Internamente la aplicaci\u00f3n hace algo as\u00ed: SELECT * FROM movies WHERE title LIKE '%avatar%'; El problema surge cuando se escriben caracteres especiales como por ejemplo ' . Hace que la consulta se rompa y demuestra que la aplicaci\u00f3n no filtra ni escapa correctamente la entrada. Se devuelve texto de error de sintaxis. Ahora, inspeccionar\u00e9 el c\u00f3digo que trata el input para ver qu\u00e9 est\u00e1 haciendo la aplicaci\u00f3n. Se puede ver en la URL que el c\u00f3digo duente que he ejecutado es sqli 1.php. Accedo al contenedor de bWAPP ( docker exec -it bwapp /bin/bash ) y muestro el contenido del archivo ( nano /var/www/html/sqli1.php ). Aqu\u00ed se muestra la funci\u00f3n con lo que se ha de realizar en base al nivel de seguridad que hayamos establecido en bWAPP. Con el nivel de seguridad m\u00e1s bajo, el 0, lo que hace la funci\u00f3n es llamar a la funci\u00f3n no_check(). Con otros niveles de seguridad se llama a las funciones xsscheck1 y xsscheck3. Indico enlace para descargar archivo completo y poder revisarlo: Descargar sqli_1.php En alguno de los siguientes m\u00f3dulos es donde se encuentran las funciones. Busco con grep para localizar los ficheros en los que aparece y la l\u00ednea Las funciones se encontraron en el archivo functions_external.php, en las l\u00edneas 19, 88 y 115. La funci\u00f3n devuelve un dato en $data y lo devuelve exactamente igual, sin validar ni filtrar ni limpiar ni proteger. No hace ning\u00fan tipo de comprobaci\u00f3n de seguridad. En una aplicaci\u00f3n seguria, antes de usar lo que el usuario escribe, se har\u00eda algo como eliminar comillas, escapar caracteres especiales, validar la longitud o usar consultas preparadas. Dejo enlace para descargar el archivo completo Descargar function_external.php En caso de que se utilizase seguridad media, La funci\u00f3n xss_check_1() aplica un filtrado insuficiente, ya que \u00fanicamente convierte los caracteres mayor que (<) y menor que (<) a entidades HTML. Adem\u00e1s, posteriormente aplica urldecode(), lo que permite que un atacante utilice codificaci\u00f3n URL para evadir el filtrado. Como consecuencia, es posible introducir c\u00f3digo malicioso que ser\u00e1 decodificado y ejecutado por el navegador, manteniendo la vulnerabilidad XSS. En caso de utilizar seguridad alta, La funci\u00f3n xss_check_3() implementa una mitigaci\u00f3n adecuada frente a ataques XSS mediante el uso de htmlspecialchars() con la opci\u00f3n ENT_QUOTES y codificaci\u00f3n UTF-8. De esta forma, todos los caracteres especiales potencialmente peligrosos (<, >, \", ', &) se convierten en entidades HTML, impidiendo que el navegador los interprete como c\u00f3digo ejecutable. A diferencia de las funciones anteriores, esta implementaci\u00f3n s\u00ed representa una defensa correcta frente a XSS reflejado.","title":"4. An\u00e1lisis de vulnerabilidad"},{"location":"reflexion/","text":"","title":"5. Reflexi\u00f3n"}]}